---
name: master
description: 중앙 컨트롤 타워 워크플로우. 사용자가 "마스터" 또는 "/master"를 입력하거나 일반적인 개발/수정 요청을 할 때 가동. 요청 의도 분석, 적절한 하위 작업 라우팅, 작업 후 문서 동기화(auto-doc-gen) 및 검증(verify)을 자동 수행.
---

# 🌐 마스터 컨트롤 프로토콜

이 워크플로우는 모든 복합 개발 요청을 처리하는 최상위 지침입니다. 요청의 의도를 분석하여 적절한 전문 워크플로우로 연결하고, 작업 완료 후 문서 동기화까지 책임집니다.

## 🚀 1단계: 요청 의도 분석 및 하이브 동기화 (Sync)

1. **상태 체크**: 작업을 시작하기 전, `.ai_monitor/data/task_logs.jsonl`을 읽어 다른 에이전트(Claude-1/2, Gemini-1/2)가 무엇을 하고 있는지 확인합니다.
2. **충돌 방지**: 수정하려는 파일에 다른 에이전트의 작업 로그가 진행 중이라면, 해당 작업이 끝날 때까지 대기하거나 작업을 위임받습니다.
3. **카테고리 분류**: 에러 수정, 새 기능, 문서화 중 요청 의도를 분석하여 적절한 워크플로우를 가동합니다.

## 🧠 2단계: 전략 수립 및 오케스트레이션 (Strategy & Orchestration)

1. **지능적 브레인스토밍**: 작업을 시작하기 전, `activate_skill: brainstorming`의 사고방식을 적용하여 사용자의 의도 뒤에 숨겨진 요구사항과 잠재적 위험 요소를 분석합니다.
2. **최적 스킬 라우팅**: 문제의 성격에 따라 필요한 전문 스킬을 스스로 호출합니다.
   - 설계/아이디어 단계: `brainstorming` 가동
   - 구현 단계: `test-driven-development` (TDD) 원칙 적용
   - 인프라/워크트리: `using-git-worktrees` 활용
3. **통합 실행 계획**: `ai_monitor_plan.md`를 바탕으로, 현재 작업에 대한 구체적인 'Action Plan'을 수립하고 사용자에게 보고합니다.

## 🚀 3단계: TDD 기반 실행 및 자가 치유 (Execution & Self-Healing)

1. **실행 (Act)**: 계획된 순서에 따라 코드를 수정합니다. 이때 모든 수정은 '검증 가능'해야 합니다.
2. **자가 치유 (Self-Healing/Debugging)**: 실행 중 에러나 테스트 실패가 발생하면, **즉시 `activate_skill: systematic-debugging` 모드로 전환**합니다.
   - **디버깅 계획 수립**: "가설 -> 검증 -> 결과"로 이어지는 체계적인 디버깅 계획을 스스로 작성하고 기록합니다.
   - 단순한 코드 수정이 아닌, 원인 분석(Root Cause Analysis)을 우선합니다.
3. **코드 내 상세 주석 (Code-as-Doc)**: 모든 소스 코드 상단에 반드시 **변경 이력(History)**, **작성자**, **수정 이유(Why)**를 한글 주석으로 명시합니다.

## 🔄 4단계: 자동 후처리 및 공유 (Hive Update) [CRITICAL]

1. **문서 자동 동기화 (auto-doc-gen)**: 
   - `ai_monitor_plan.md` (전체 로드맵) 및 `CHANGELOG.md` 업데이트.
   - **[핵심] 중앙 프로젝트 맵 업데이트**: 파일을 수정하거나 생성한 경우, 루트의 `PROJECT_MAP.md`에 해당 파일의 역할과 위치를 최신 상태로 반영합니다.
   - **[핵심] 코드 내 상세 주석 (Code-as-Doc)**: 모든 소스 코드 상단에 반드시 **변경 이력(History)**, **작성자**, **수정 이유(Why)**를 한글 주석으로 명시합니다.
2. **의도 중심의 한글 주석 작성**: 코드 내의 모든 주석은 단순한 기능 설명이 아닌, '왜(Why)' 이렇게 구현했는지에 대한 설계 의도를 **"한글로 아주 자세하게"** 작성해야 합니다.
3. **하이브 마인드 로깅 (Hive Logging)**: `scripts/hive_bridge.py`를 호출하여 작업 결과와 다음 단계를 공유합니다.
   - 예: `python scripts/hive_bridge.py "Gemini-1" "Task completed: App.tsx refactoring. Ready for Claude-2 to style."`
4. **최종 보고**: 사용자에게 작업 결과와 에이전트 간 협업 내역을 간결하게 보고합니다.

## 🧬 4단계: 자가 학습 및 진화 (Meta-Learning & Evolution) [AUTONOMOUS]

작업을 완료한 후, 에이전트는 스스로 방금 수행한 작업을 되돌아보고 다음 조치를 취해야 합니다.

1. **패턴 감지**: 이번에 수행한 작업(예: 특정 라이브러리 세팅, 반복되는 버그 수정 패턴)이 앞으로도 자주 발생할 것 같은지 판단합니다.
2. **지식 업데이트**: 프로젝트만의 고유한 규칙이 새롭게 생겼다면, `.gemini/skills/master/references/` 폴더 내의 관련 문서(예: `react_best_practices.md` 등)를 스스로 편집하여 지식을 업데이트합니다.
3. **신규 스킬 창조**: 완전히 새로운 유형의 복잡한 워크플로우를 성공적으로 수행했다면, `activate_skill: skill-creator` 능력을 발동하여 **스스로 새로운 스킬 폴더와 SKILL.md를 생성**합니다. (이때 사용자에게 "새로운 최적화 패턴을 발견하여 스킬로 저장했습니다"라고 보고합니다.)

## 🔍 5단계: 스킬 관리 및 검색 (Skill Hub Management)

사용자가 새로운 기능이나 전문 지식을 요청할 때, 혹은 시스템 기능을 확장해야 할 때 다음 절차를 따릅니다.

1. **스킬 탐색 및 검색**: 
   - 사용자가 "~~한 스킬 검색해줘" 또는 "~~ 기능 추가해줘"라고 요청하면, `scripts/skill_manager.py search --query "키워드"`를 호출하여 공개된 스킬이나 확장 기능이 있는지 먼저 확인합니다.
   - 필요 시 `google_web_search`를 병행하여 최신 스킬 정보를 수집합니다.
2. **스킬 설치**: 유용한 스킬이 발견되면 사용자에게 보고 후 `scripts/skill_manager.py install`을 통해 `.gemini/skills/`에 설치합니다.
3. **로컬 스킬 관리**: `scripts/skill_manager.py list`를 주기적으로 실행하여 현재 프로젝트에 가용한 스킬 셋을 파악하고, Gemini와 Claude가 동일한 스킬 지침을 공유하도록 유도합니다.
4. **대시보드 연동**: 모든 스킬 상태 변화는 `vibe-view` 대시보드에서 시각적으로 확인할 수 있도록 로그를 남깁니다.
